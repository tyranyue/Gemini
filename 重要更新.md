# 🎉 重要更新：现在自动保存图片了！

## ✨ 新功能

之前脚本只保存文本格式的结果，现在已经升级：

### 📸 **自动保存生成的图片**
- 所有生成的图片自动保存到 `output/` 文件夹
- 图片命名格式：`原文件名_enhanced.png`
- 不再在 JSON 文件中显示冗长的 base64 数据

## 🚀 快速开始

### 第一步：测试配置（强烈推荐）
```bash
python test_single_image.py
```
这会测试你的配置是否正确，并显示单张图片的处理结果。

### 第二步：批量处理
1. 将所有要处理的图片放入 `images` 文件夹
2. 运行：
```bash
python batch_image_enhancer.py --config config.json
```

### 第三步：查看结果
- **生成的图片**：在 `output/` 文件夹中
- **处理日志**：`results.json` 和 `results.txt`

## 📁 文件结构示例

```
Gemini/
├── images/              # 原始图片
│   ├── photo1.jpg
│   ├── photo2.png
│   └── photo3.jpg
├── output/              # ⭐ 生成的美化图片
│   ├── photo1_enhanced.png
│   ├── photo2_enhanced.png
│   └── photo3_enhanced.png
├── results.json         # 处理日志（JSON）
└── results.txt          # 处理日志（文本）
```

## ⚙️ 配置说明

`config.json` 中新增了 `output_dir` 参数：

```json
{
  "api_key": "你的密钥",
  "base_url": "https://ggdl.haohaozhongzhuan.com/v1",
  "input_dir": "./images",
  "output_dir": "output",     // ⭐ 新增：输出图片目录
  "prompt": "你的提示词",
  "model": "gemini-2.5-flash-image-preview",
  "output_file": "results.json",
  "delay": 1.0,
  "temperature": 0.0,
  "max_tokens": 2048
}
```

## 🔧 技术改进

1. **自动解析图片数据**：从 API 响应中提取 base64 图片数据
2. **自动解码保存**：将 base64 数据解码为真实图片文件
3. **智能命名**：保持原文件名，添加 `_enhanced` 后缀
4. **性能优化**：不在日志中保存大量 base64 数据，减小文件体积

## 💡 使用提示

- 首次运行建议先用 `test_single_image.py` 测试
- 生成的图片统一为 PNG 格式（保证质量）
- `output` 文件夹会自动创建，不需要手动创建
- 可以通过 `--output-dir` 参数自定义输出目录

## 🎯 完整命令示例

```bash
# 使用配置文件（推荐）
python batch_image_enhancer.py --config config.json

# 自定义输出目录
python batch_image_enhancer.py --config config.json --output-dir "my_output"

# 测试单张图片
python test_single_image.py
```

---

现在你可以直接获得美化后的图片文件，而不是只有文本数据了！🎨✨

