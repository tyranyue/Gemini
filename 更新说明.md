# æ›´æ–°è¯´æ˜ - å·²é€‚é…ä½ çš„ OpenAI è°ƒç”¨æ–¹å¼

## âœ… å®Œæˆçš„æ›´æ–°

æ ¹æ®ä½ æä¾›çš„ `pythonç”¨openAI.ipynb` ç¤ºä¾‹ï¼Œè„šæœ¬å·²å®Œå…¨é€‚é…ï¼

### ğŸ”§ ä¸»è¦æ”¹åŠ¨

#### 1. **API ç«¯ç‚¹é…ç½®**
- âœ… æ·»åŠ  `base_url` æ”¯æŒï¼š`https://ggdl.haohaozhongzhuan.com/v1`
- âœ… ä¸ä½ çš„ Notebook ä¸­çš„è°ƒç”¨æ–¹å¼ä¸€è‡´

#### 2. **æ¨¡å‹é…ç½®**
- âœ… æ›´æ–°é»˜è®¤æ¨¡å‹ä¸ºï¼š`gemini-2.5-flash-image-preview`
- âœ… ä¸ä½  Notebook ä¸­ä½¿ç”¨çš„æ¨¡å‹å®Œå…¨ç›¸åŒ

#### 3. **å›¾ç‰‡ç¼–ç æ–¹å¼**
- âœ… ä½¿ç”¨ base64 ç¼–ç 
- âœ… æ ¼å¼æ”¹ä¸º `data:image/png;base64,{base64_image}`
- âœ… å›¾ç‰‡æ”¾åœ¨æ¶ˆæ¯çš„å‰é¢ï¼Œæç¤ºè¯åœ¨åé¢ï¼ˆç¬¦åˆä½ çš„ä»£ç é£æ ¼ï¼‰

#### 4. **æ–°å¢å‚æ•°æ”¯æŒ**
- âœ… `temperature`: æ§åˆ¶è¾“å‡ºçš„éšæœºæ€§ï¼ˆé»˜è®¤ 0.0ï¼‰
- âœ… `max_tokens`: æ§åˆ¶æœ€å¤§å“åº”é•¿åº¦ï¼ˆé»˜è®¤ 2048ï¼‰
- âœ… ä¸ä½ çš„ Notebook ä¸­çš„å‚æ•°è®¾ç½®ä¸€è‡´

### ğŸ“ é…ç½®æ–‡ä»¶ (config.json)

```json
{
  "api_key": "sk-aow8H8134VwDz5x8G814MuSgI4XTzAOJYxSuEvFM9hgDcJW3",
  "base_url": "https://ggdl.haohaozhongzhuan.com/v1",
  "input_dir": "./images",
  "prompt": "åšç‰©é¦†å±•è§ˆé£æ ¼çš„ç¾åŒ–æç¤ºè¯...",
  "model": "gemini-2.5-flash-image-preview",
  "output_file": "results.json",
  "delay": 1.0,
  "temperature": 0.0,
  "max_tokens": 2048
}
```

### ğŸ¯ ä»£ç å¯¹æ¯”

#### ä½ çš„ Notebook ä»£ç ï¼š
```python
client = OpenAI(
    api_key=API_KEY,
    base_url=OPENAI_BASE_URL,
)

response = client.chat.completions.create(
    model="gemini-2.5-flash-image-preview",
    messages=messages,
    temperature=0.0,
    max_tokens=2048,
)
```

#### æˆ‘ä»¬çš„è„šæœ¬ä»£ç ï¼š
```python
client = OpenAI(
    api_key=api_key, 
    base_url=base_url
)

response = client.chat.completions.create(
    model=self.model_name,  # gemini-2.5-flash-image-preview
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "image_url",
                    "image_url": {"url": f"data:image/png;base64,{base64_image}"}
                },
                {"type": "text", "text": prompt}
            ]
        }
    ],
    temperature=self.temperature,  # 0.0
    max_tokens=self.max_tokens      # 2048
)
```

âœ… **å®Œå…¨ä¸€è‡´ï¼**

## ğŸ“¦ æ–°å¢æ–‡ä»¶

### 1. `test_single_image.py` - å¿«é€Ÿæµ‹è¯•è„šæœ¬
ç”¨äºæµ‹è¯•é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œåªå¤„ç†ä¸€å¼ å›¾ç‰‡ã€‚

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# è‡ªåŠ¨ä» images æ–‡ä»¶å¤¹é€‰æ‹©ç¬¬ä¸€å¼ å›¾ç‰‡æµ‹è¯•
python test_single_image.py

# æµ‹è¯•æŒ‡å®šå›¾ç‰‡
python test_single_image.py path/to/your/image.jpg
```

## ğŸš€ ä½¿ç”¨æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šæµ‹è¯•é…ç½®ï¼ˆæ¨èï¼‰
```bash
python test_single_image.py
```

å¦‚æœæˆåŠŸï¼Œä½ ä¼šçœ‹åˆ°ï¼š
```
âœ… æˆåŠŸæ”¶åˆ°å“åº”ï¼
ğŸ“„ API å“åº”å†…å®¹:
====================================
[è¿™é‡Œæ˜¯ API çš„å“åº”å†…å®¹]
====================================
âœ… æµ‹è¯•æˆåŠŸï¼é…ç½®æ­£ç¡®ï¼Œå¯ä»¥å¼€å§‹æ‰¹é‡å¤„ç†äº†ã€‚
```

### ç¬¬äºŒæ­¥ï¼šæ‰¹é‡å¤„ç†
```bash
python batch_image_enhancer.py --config config.json
```

## ğŸ“‹ å®Œæ•´çš„é…ç½®å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | ä½ çš„è®¾ç½® |
|------|------|--------|----------|
| `api_key` | API å¯†é’¥ | - | âœ… å·²è®¾ç½® |
| `base_url` | API ç«¯ç‚¹ | - | âœ… `https://ggdl.haohaozhongzhuan.com/v1` |
| `model` | æ¨¡å‹åç§° | `gemini-2.5-flash-image-preview` | âœ… å·²é…ç½® |
| `input_dir` | å›¾ç‰‡ç›®å½• | `./images` | âœ… å·²åˆ›å»º |
| `prompt` | æç¤ºè¯ | - | âœ… åšç‰©é¦†é£æ ¼ |
| `output_file` | è¾“å‡ºæ–‡ä»¶ | `results.json` | âœ… é»˜è®¤ |
| `delay` | è¯·æ±‚å»¶è¿Ÿ | 1.0 ç§’ | âœ… 1.0 |
| `temperature` | æ¸©åº¦å‚æ•° | 0.0 | âœ… 0.0 |
| `max_tokens` | æœ€å¤§ token | 2048 | âœ… 2048 |

## ğŸ’¡ ä¸ä½ çš„ Notebook çš„åŒºåˆ«

| åŠŸèƒ½ | Notebook | æ‰¹é‡è„šæœ¬ |
|------|----------|----------|
| å¤„ç†æ–¹å¼ | æ‰‹åŠ¨é€ä¸ª | è‡ªåŠ¨æ‰¹é‡ |
| å†å²å¯¹è¯ | æ”¯æŒ | ä¸æ”¯æŒï¼ˆæ¯å¼ å›¾ç‹¬ç«‹ï¼‰ |
| å¤šå›¾å¯¹æ¯” | æ”¯æŒ (image1, image2) | ä¸æ”¯æŒï¼ˆå•å›¾å¤„ç†ï¼‰ |
| è¿›åº¦æ˜¾ç¤º | æ—  | âœ… æœ‰è¿›åº¦æ¡ |
| ç»“æœä¿å­˜ | æ—  | âœ… JSON + TXT |
| é”™è¯¯é‡è¯• | æ—  | âœ… è‡ªåŠ¨é‡è¯• 3 æ¬¡ |
| é€Ÿç‡æ§åˆ¶ | æ—  | âœ… å¯é…ç½®å»¶è¿Ÿ |

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **å…ˆæµ‹è¯•**ï¼š
   ```bash
   python test_single_image.py
   ```

2. **å¦‚æœæµ‹è¯•æˆåŠŸï¼Œå¼€å§‹æ‰¹é‡å¤„ç†**ï¼š
   - å°†æ‰€æœ‰å›¾ç‰‡æ”¾å…¥ `images` æ–‡ä»¶å¤¹
   - è¿è¡Œï¼š`python batch_image_enhancer.py --config config.json`

3. **æŸ¥çœ‹ç»“æœ**ï¼š
   - `results.json` - è¯¦ç»†çš„ JSON æ ¼å¼
   - `results.txt` - æ˜“è¯»çš„æ–‡æœ¬æ ¼å¼

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚æœæˆ‘æƒ³ä¿®æ”¹æç¤ºè¯æ€ä¹ˆåŠï¼Ÿ
A: ç›´æ¥ç¼–è¾‘ `config.json` ä¸­çš„ `prompt` å­—æ®µå³å¯ã€‚

### Q: å¦‚ä½•å¢åŠ è¯·æ±‚å»¶è¿Ÿé¿å…é™æµï¼Ÿ
A: ä¿®æ”¹ `config.json` ä¸­çš„ `delay` å€¼ï¼Œå¦‚æ”¹ä¸º `2.0` è¡¨ç¤ºæ¯æ¬¡è¯·æ±‚é—´éš” 2 ç§’ã€‚

### Q: æ”¯æŒå¤šå›¾å¯¹æ¯”å—ï¼ˆåƒ Notebook ä¸­çš„ image1, image2ï¼‰ï¼Ÿ
A: å½“å‰ç‰ˆæœ¬ä¸æ”¯æŒã€‚å¦‚éœ€æ­¤åŠŸèƒ½ï¼Œå¯ä»¥åŸºäºä½ çš„ Notebook ä»£ç å•ç‹¬å¤„ç†ã€‚

### Q: èƒ½ä¿ç•™å¯¹è¯å†å²å—ï¼Ÿ
A: å½“å‰ç‰ˆæœ¬æ¯å¼ å›¾ç‰‡ç‹¬ç«‹å¤„ç†ã€‚å¦‚éœ€å¯¹è¯åŠŸèƒ½ï¼Œå»ºè®®ä½¿ç”¨ä½ çš„ Notebookã€‚

## ğŸ“ è·å–å¸®åŠ©

æŸ¥çœ‹æ‰€æœ‰å‚æ•°ï¼š
```bash
python batch_image_enhancer.py --help
python test_single_image.py --help
```

---

**æ€»ç»“**ï¼šè„šæœ¬å·²å®Œå…¨é€‚é…ä½ çš„è°ƒç”¨æ–¹å¼ï¼Œç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼ğŸ‰

